{% extends "base.html" %}

{% block title %}Kraitif - Story Types & Story Creator{% endblock %}

{% block content %}
<div class="header-section">
    <h1>Kraitif - Story Types & Story Creator</h1>
    <p class="subtitle">Explore classical story types and create your own stories</p>
</div>

<div class="main-actions">
    <a href="{{ url_for('create_story') }}" class="btn btn-primary">Create New Story</a>
    <a href="{{ url_for('list_stories') }}" class="btn btn-secondary">View My Stories</a>
    <a href="{{ url_for('story_types') }}" class="btn btn-secondary">Explore Story Types</a>
</div>

{% if user_stories %}
<div class="section">
    <h2>Recent Stories</h2>
    <div class="stories-grid">
        {% for story in user_stories %}
        <div class="story-card" onclick="location.href='{{ url_for('view_story', story_index=loop.index0) }}'">
            <div class="story-title">{{ story.title }}</div>
            
            {% if story.description %}
            <div class="story-description">{{ story.description[:100] }}{% if story.description|length > 100 %}...{% endif %}</div>
            {% endif %}
            
            {% if story.genre %}
            <div class="story-meta">
                <span class="meta-item">{{ story.genre.name }}</span>
                {% if story.sub_genre %}
                <span class="meta-separator">•</span>
                <span class="meta-item">{{ story.sub_genre.name }}</span>
                {% endif %}
            </div>
            {% endif %}
            
            {% if story.story_type %}
            <div class="story-meta">
                <span class="meta-item">{{ story.story_type.name }}</span>
                {% if story.story_subtype %}
                <span class="meta-separator">•</span>
                <span class="meta-item">{{ story.story_subtype.name }}</span>
                {% endif %}
            </div>
            {% endif %}
            
            {% if story.archetypes %}
            <div class="story-archetypes">
                <strong>Archetypes:</strong> {{ story.archetypes[:3] | map(attribute='name') | join(', ') }}
                {% if story.archetypes|length > 3 %}
                <span class="archetype-count">+{{ story.archetypes|length - 3 }} more</span>
                {% endif %}
            </div>
            {% endif %}
            
            <div class="story-completion">
                <div class="completion-bar">
                    <div class="completion-fill" style="width: {{ story.completion_percentage }}%"></div>
                </div>
                <span class="completion-text">{{ "%.0f"|format(story.completion_percentage) }}% complete</span>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<div class="section">
    <h2>Seven Classical Story Types</h2>
    <div class="story-types-grid">
        {% for story_type in story_types %}
        <div class="story-type-card" onclick="location.href='{{ url_for('story_type_detail', story_type_name=story_type.name) }}'">
            <div class="story-type-title">{{ story_type.name }}</div>
            <div class="story-type-description">{{ story_type.description }}</div>
            
            {% if story_type.examples %}
            <div class="story-type-examples">
                <strong>Examples:</strong> {{ story_type.examples | join(', ') }}
            </div>
            {% endif %}
            
            {% if story_type.key_theme %}
            <div class="story-type-characteristics">
                <strong>Key Theme:</strong> {{ story_type.key_theme }}
            </div>
            {% endif %}
            
            <div class="story-type-characteristics">
                <strong>Subtypes:</strong> {{ story_type.subtypes | length }} available
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}